+++
categories = ["Miscs"]
tags = ["Miscs"]
title  = "ActiveX控件在浏览器中使用的注意事项"
isCJKLanguage = true
date = "2015-05-08T22:17:04+08:00"
type="post"
+++

好吧，我承认这段事件做的工作是和前端的关系比较大，但其实最主要的功能是我们的合作方提供的一个ActiveX控件完成的，而我需要让我的用户在浏览器中调用这个控件。

> ActiveX控件真的是很过时的技术，但不得不承认目前的用途还是比较多，因为要和硬件打交道，这方面我的知识比较欠缺，连搜索的关键词都想不到。

这样一来，自然而言的就产生了一些限制。

1. 用户操作系统—— Windows
2. 用户客户端—— Internet Explorer
3. 操作系统注册ActiveX控件
4. 浏览器进行相应的安全设置

对，我主要说的就是这第四条，这里满满的槽点。

先说解决方案
1. 将网址加入到“受信任的站点列表”中。这一步可以ActiveX控件在浏览器中加载并执行，但它会在每次打开的时候询问。
2. 选择安全等级的自定义，选中“对未标记为可安全执行脚本的ActiveX控件初始化并执行脚本”的“启用”项。这一下就不需要询问了。


首先，当没有把网站加到“受信任的站点列表”时，我能看到的结果就是功能无法执行——问题是如果代码在我本地的硬盘里，直接右键用IE打开是可以执行的，而只要一放在服务器上就不行了。网上搜索一下，关于ActiveX的帖子很少，而在这很少的帖子里面有很多遇到这种问题，但通常是自己写的控件出现的，我对Windows的这项技术完全没有兴趣，也就没有去研究如何编写一个控件了。重点是帖子虽然并不少，但都是问道最后也没有个结果。终于找到一个说到解决方案的，说是要实现一个接口，我心想我这也不是.NET平台，难不成还用JS给你实现接口？肯定不
可能，最终终于让我在一个犄角旮旯发现了这个问题的答案——“受信任站点”，而且这个作者也强调，如果不加入受信任站点，即使在安全自定义里面开启了上面解决方案的第二步也是不起作用的。

对，现在有了解决方案，但我不理解的是微软为什么不弹出一个提示告诉我这是这个问题引起的呢？

本地的代码能执行，放在远端的服务器上就不行，而我的服务器又是运行Nginx的Linux服务器，我很难不把这个问题联想到平台的不兼容上去，甚至想到了在Linux上安装ActiveX控件——当然这个不是我提出来的，很明显不可能。或者服务器用Windows平台的IIS，我甚至用这个方案在我本地也搭了一个IIS服务器，结果还是一样的，只要是通过网络协议访问就是不行。

最后我都已经怀疑这个方案是不是有问题，根本不可能实现时，看到了这个帖子。当时激动的我差点喊出来。

我只想说一声Microsoft SUCKS!!!
